# ğŸ–¼ï¸ Image Classification & Regression with Neural-Forge-Ai  

Image classification is a **supervised learning** approach where a model is trained to **identify and categorize objects** within images.  
Neural-Forge-Ai makes the process **simple and intuitive**, allowing users to train powerful classification models by **uploading labeled images**.  

Image regression (or scoring) is a **related task** where a model predicts a **score or value** for an image.  
Neural-Forge-Ai enables the creation of **state-of-the-art** image scoring models with minimal configuration.  

---

## ğŸ“‚ Preparing Your Data  

### ğŸ“Œ Organizing Data for **Image Classification**  

To train an image classification model, prepare a **zip file** structured as follows:  

cats_and_dogs.zip â”œâ”€â”€ cats â”‚ â”œâ”€â”€ cat.1.jpg â”‚ â”œâ”€â”€ cat.2.jpg â”‚ â”œâ”€â”€ cat.3.jpg â”‚ â””â”€â”€ ... â””â”€â”€ dogs â”œâ”€â”€ dog.1.jpg â”œâ”€â”€ dog.2.jpg â”œâ”€â”€ dog.3.jpg â””â”€â”€ ...

 

Each **folder name** represents a **class**, and its contents are **images of that class**.  
ğŸ’¡ Example dataset: **[truepositive/hotdog_nothotdog](https://huggingface.co/datasets/truepositive/hotdog_nothotdog)**  

---

### ğŸ“Œ Organizing Data for **Image Regression / Scoring**  

For image regression, create a **zip file** containing:  

Archive.zip â”œâ”€â”€ 0001.png â”œâ”€â”€ 0002.png â”œâ”€â”€ 0003.png â”œâ”€â”€ ... â””â”€â”€ metadata.jsonl

css
Copy
Edit

ğŸ“„ Example `metadata.jsonl`:  

```json
{"file_name": "0001.png", "target": 0.5}
{"file_name": "0002.png", "target": 0.7}
{"file_name": "0003.png", "target": 0.3}
ğŸ’¡ Example dataset: abhishek/img-quality-full

ğŸ“Œ Image Requirements
âœ… Formats: JPEG, JPG, PNG
âœ… At least 5 images per class for classification
âœ… No extra files in the dataset (only images + metadata.jsonl for regression)
âœ… Folder name = Class label (for classification)

Additional Tips

âœ… Uniform image sizes can improve accuracy
âœ… Include diverse examples for better model generalization
ğŸ”— Column Mapping
âœ… For Image Classification
If using a zip dataset format, the column mapping should remain default:

 
data:
  column_mapping:
    image_column: image
    target_column: label
âœ… For Image Regression
Ensure correct mapping:

 
data:
  column_mapping:
    image_column: image
    target_column: target
ğŸš€ Training
ğŸ  Local Training
To train a model locally, create a config file (config.yaml):

ğŸ”¹ Image Classification Example
 
task: image_classification
base_model: google/vit-base-patch16-224
project_name: neural-forge-cats-vs-dogs
log: tensorboard
backend: local

data:
  path: cats_vs_dogs
  train_split: train
  valid_split: null
  column_mapping:
    image_column: image
    target_column: label

params:
  epochs: 2
  batch_size: 4
  lr: 2e-5
  optimizer: adamw_torch
  scheduler: linear
  gradient_accumulation: 1
  mixed_precision: fp16

hub:
  username: ${HF_USERNAME}
  token: ${HF_TOKEN}
  push_to_hub: true
ğŸ”¹ Image Regression Example
 
task: image_regression
base_model: microsoft/resnet-50
project_name: neural-forge-img-quality
log: tensorboard
backend: local

data:
  path: abhishek/img-quality-full
  train_split: train
  valid_split: null
  column_mapping:
    image_column: image
    target_column: target

params:
  epochs: 10
  batch_size: 8
  lr: 2e-3
  optimizer: adamw_torch
  scheduler: cosine
  gradient_accumulation: 1
  mixed_precision: fp16

hub:
  username: ${HF_USERNAME}
  token: ${HF_TOKEN}
  push_to_hub: true
â–¶ï¸ Run Local Training
bash
Copy
Edit
$ neural-forge-ai --config config.yaml
â˜ï¸ Training on Hugging Face Spaces
To train a model on Hugging Face Spaces, set up a training space as described in the Quickstart section.

ğŸ’¡ Example UI for Image Scoring Training:



This example uses:
âœ” Model: microsoft/resnet-50
âœ” Dataset: abhishek/img-quality-full
âœ” Epochs: 3
âœ” Batch Size: 8
âœ” Learning Rate: 5e-5
âœ” Optimizer: adamw_torch
âœ” Scheduler: linear

ğŸ”¹ Column Mapping: "target" maps to "quality_mos" in the dataset.

To start training, click the Start Training button in the UI.

ğŸ›  Parameter Reference
ğŸ“Œ Image Classification Parameters
[[nuraldoc]] trainers.image_classification.params.ImageClassificationParams

ğŸ“Œ Image Regression Parameters
[[nuraldoc]] trainers.image_regression.params.ImageRegressionParams

ğŸ¯ Why Use Neural-Forge-Ai for Image Training?
âœ… No-Code & Low-Code Training â€“ UI-based workflow or Python API.
âœ… Multi-Domain Support â€“ Image Classification, Regression, Object Detection, etc.
âœ… Optimized for GPUs â€“ Fast model training & inference.
âœ… Cloud & Local Training â€“ Flexibility to train anywhere.
âœ… Seamless Hugging Face Integration â€“ Push models with one command.

ğŸš€ Start training your AI models with Neural-Forge-Ai today!